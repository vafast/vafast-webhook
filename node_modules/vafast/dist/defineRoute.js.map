{"version":3,"sources":["../src/defineRoute.ts"],"sourcesContent":["import type { RouteSchema } from \"./types\";\nimport type { InferableHandler } from \"./utils/create-handler\";\n\n/**\n * å¯æ¨æ–­çš„è·¯ç”±ç±»å‹ï¼ˆç”¨äºç±»å‹æ¨æ–­ï¼‰\n * ä¾› vafast-api-client ä½¿ç”¨ï¼Œä¿ç•™å®Œæ•´çš„ç±»å‹ä¿¡æ¯\n */\nexport type InferableRoute<\n  TMethod extends string = string,\n  TPath extends string = string,\n  TReturn = unknown,\n  TSchema extends RouteSchema = RouteSchema\n> = {\n  readonly method: TMethod;\n  readonly path: TPath;\n  readonly handler: InferableHandler<TReturn, TSchema>;\n  readonly middleware?: ReadonlyArray<(req: Request, next: () => Promise<Response>) => Promise<Response>>;\n}\n\n/**\n * ä¸­é—´ä»¶ç±»å‹\n */\ntype Middleware = (req: Request, next: () => Promise<Response>) => Promise<Response>;\n\n/**\n * è·¯ç”±å®šä¹‰ç±»å‹ï¼ˆä¿ç•™å®Œæ•´ handler ç±»å‹ï¼‰\n */\nexport type RouteDefinition<\n  TMethod extends string = string,\n  TPath extends string = string,\n  THandler = unknown\n> = {\n  readonly method: TMethod;\n  readonly path: TPath;\n  readonly handler: THandler;\n  readonly middleware?: ReadonlyArray<Middleware>;\n}\n\n/**\n * åˆ›å»ºå•ä¸ªè·¯ç”±å®šä¹‰ï¼ˆè‡ªåŠ¨ä¿ç•™å­—é¢é‡ç±»å‹ï¼Œæ— éœ€ as constï¼‰\n * \n * @example\n * ```typescript\n * import { route, defineRoutes, createHandler, Type } from 'vafast'\n * \n * const routes = defineRoutes([\n *   route('GET', '/users', createHandler(\n *     { query: Type.Object({ page: Type.Number() }) },\n *     async ({ query }) => ({ users: [], total: 0 })\n *   )),\n *   route('POST', '/users', createHandler(\n *     { body: Type.Object({ name: Type.String() }) },\n *     async ({ body }) => ({ id: '1', name: body.name })\n *   )),\n *   route('GET', '/users/:id', createHandler(\n *     { params: Type.Object({ id: Type.String() }) },\n *     async ({ params }) => ({ id: params.id, name: 'User' })\n *   ))\n * ])\n * \n * // æ— éœ€ as constï¼ç±»å‹è‡ªåŠ¨æ¨æ–­\n * type Api = InferEden<typeof routes>\n * ```\n */\nexport function route<\n  TMethod extends string,\n  TPath extends string,\n  THandler\n>(\n  method: TMethod,\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<TMethod, TPath, THandler> {\n  return {\n    method,\n    path,\n    handler,\n    middleware\n  };\n}\n\n/**\n * GET è·¯ç”±å¿«æ·æ–¹æ³•\n */\nexport function get<TPath extends string, THandler>(\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<'GET', TPath, THandler> {\n  return route('GET', path, handler, middleware);\n}\n\n/**\n * POST è·¯ç”±å¿«æ·æ–¹æ³•\n */\nexport function post<TPath extends string, THandler>(\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<'POST', TPath, THandler> {\n  return route('POST', path, handler, middleware);\n}\n\n/**\n * PUT è·¯ç”±å¿«æ·æ–¹æ³•\n */\nexport function put<TPath extends string, THandler>(\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<'PUT', TPath, THandler> {\n  return route('PUT', path, handler, middleware);\n}\n\n/**\n * DELETE è·¯ç”±å¿«æ·æ–¹æ³•\n */\nexport function del<TPath extends string, THandler>(\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<'DELETE', TPath, THandler> {\n  return route('DELETE', path, handler, middleware);\n}\n\n/**\n * PATCH è·¯ç”±å¿«æ·æ–¹æ³•\n */\nexport function patch<TPath extends string, THandler>(\n  path: TPath,\n  handler: THandler,\n  middleware?: Middleware[]\n): RouteDefinition<'PATCH', TPath, THandler> {\n  return route('PATCH', path, handler, middleware);\n}\n\n/**\n * å®šä¹‰è·¯ç”±æ•°ç»„ï¼ˆä¿ç•™å®Œæ•´ç±»å‹ä¿¡æ¯ï¼‰\n * \n * æ¨èé…åˆ route() å‡½æ•°ä½¿ç”¨ï¼Œæ— éœ€ as const\n * \n * @example\n * ```typescript\n * import { defineRoutes, route, createHandler, Type } from 'vafast'\n * \n * // âœ¨ æ–°æ–¹å¼ï¼šä½¿ç”¨ route() å‡½æ•°ï¼Œæ— éœ€ as const\n * const routes = defineRoutes([\n *   route('GET', '/users', createHandler(...)),\n *   route('POST', '/users', createHandler(...))\n * ])\n * \n * // ğŸ”™ æ—§æ–¹å¼ï¼šéœ€è¦ as constï¼ˆä»ç„¶æ”¯æŒï¼‰\n * const routes = defineRoutes([\n *   { method: 'GET', path: '/users', handler: createHandler(...) }\n * ] as const)\n * ```\n */\nexport function defineRoutes<\n  const T extends readonly {\n    readonly method: string\n    readonly path: string\n    readonly handler: unknown\n    readonly middleware?: ReadonlyArray<Middleware>\n  }[]\n>(routes: T): T {\n  return routes;\n}\n"],"mappings":";AAgEO,SAAS,MAKd,QACA,MACA,SACA,YAC2C;AAC3C,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAKO,SAAS,IACd,MACA,SACA,YACyC;AACzC,SAAO,MAAM,OAAO,MAAM,SAAS,UAAU;AAC/C;AAKO,SAAS,KACd,MACA,SACA,YAC0C;AAC1C,SAAO,MAAM,QAAQ,MAAM,SAAS,UAAU;AAChD;AAKO,SAAS,IACd,MACA,SACA,YACyC;AACzC,SAAO,MAAM,OAAO,MAAM,SAAS,UAAU;AAC/C;AAKO,SAAS,IACd,MACA,SACA,YAC4C;AAC5C,SAAO,MAAM,UAAU,MAAM,SAAS,UAAU;AAClD;AAKO,SAAS,MACd,MACA,SACA,YAC2C;AAC3C,SAAO,MAAM,SAAS,MAAM,SAAS,UAAU;AACjD;AAuBO,SAAS,aAOd,QAAc;AACd,SAAO;AACT;","names":[]}