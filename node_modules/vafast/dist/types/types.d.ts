type Method = "GET" | "POST" | "PUT" | "DELETE" | "PATCH" | "OPTIONS" | "HEAD";
/** 支持的响应类型 - 由 mapResponse 自动转换 */
type ResponseBody = Response | string | number | boolean | object | null | undefined | ReadableStream | Blob | ArrayBuffer;
/** Handler 返回值（支持同步/异步，任意类型） */
/** 传统 Handler 类型 */
type LegacyHandler = (req: Request, params?: Record<string, string>, user?: Record<string, any>) => ResponseBody | Promise<ResponseBody>;
/** createHandler 返回的类型 */
type FactoryHandler = (req: Request) => Promise<Response>;
/** Handler 联合类型（支持两种风格） */
type Handler = LegacyHandler | FactoryHandler;
/** 中间件（返回值必须是 Response 或 Promise<Response>） */
type Middleware = (req: Request, next: () => Promise<Response>) => Response | Promise<Response>;
interface Route {
    method: Method;
    path: string;
    handler: Handler;
    middleware?: Middleware[];
    /** 路由名称（用于文档、事件等） */
    name?: string;
    /** 路由描述 */
    description?: string;
    /** 允许任意扩展（支持 Webhook、权限等插件） */
    [key: string]: unknown;
}
interface NestedRoute {
    path: string;
    middleware?: Middleware[];
    children?: (NestedRoute | Route)[];
    /** 路由组名称 */
    name?: string;
    /** 路由组描述 */
    description?: string;
    /** 允许任意扩展 */
    [key: string]: unknown;
}
interface FlattenedRoute extends Route {
    fullPath: string;
    middlewareChain: Middleware[];
}

export type { FactoryHandler, FlattenedRoute, Handler, LegacyHandler, Method, Middleware, NestedRoute, ResponseBody, Route };
