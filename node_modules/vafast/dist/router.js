// src/router.ts
function flattenNestedRoutes(routes) {
  const flattened = [];
  function processRoute(route, parentPath = "", parentMiddleware = []) {
    const currentPath = normalizePath(parentPath + route.path);
    const currentMiddleware = [
      ...parentMiddleware,
      ...route.middleware || []
    ];
    if ("method" in route && "handler" in route) {
      const leafRoute = route;
      flattened.push({
        ...leafRoute,
        fullPath: currentPath,
        middlewareChain: currentMiddleware
      });
    } else if ("children" in route && route.children) {
      for (const child of route.children) {
        processRoute(child, currentPath, currentMiddleware);
      }
    }
  }
  for (const route of routes) {
    processRoute(route);
  }
  return flattened;
}
function normalizePath(path) {
  let normalized = decodeURIComponent(path);
  normalized = normalized.replace(/\/+/g, "/");
  if (normalized === "") return "/";
  if (normalized !== "/" && normalized.endsWith("/")) {
    normalized = normalized.slice(0, -1);
  }
  return normalized;
}
export {
  flattenNestedRoutes,
  normalizePath
};
//# sourceMappingURL=router.js.map