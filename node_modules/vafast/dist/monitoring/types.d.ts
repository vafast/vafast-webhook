/**
 * 性能监控系统类型定义
 *
 * @author Framework Team
 * @version 1.0.0
 * @license MIT
 */
interface BaseMetrics {
    timestamp: number;
    requestId: string;
    method: string;
    path: string;
    statusCode: number;
    userAgent?: string;
    ip?: string;
}
interface PerformanceMetrics extends BaseMetrics {
    totalTime: number;
    routeMatchTime: number;
    validationTime: number;
    handlerTime: number;
    responseTime: number;
    memoryUsage: {
        heapUsed: number;
        heapTotal: number;
        external: number;
        rss: number;
    };
    validation: {
        bodyValidated: boolean;
        queryValidated: boolean;
        paramsValidated: boolean;
        headersValidated: boolean;
        cookiesValidated: boolean;
        validationErrors: number;
    };
    routing: {
        routeFound: boolean;
        middlewareCount: number;
        dynamicParams: number;
    };
    error?: {
        type: string;
        message: string;
        stack?: string;
    };
}
interface AggregatedMetrics {
    timeRange: {
        start: number;
        end: number;
    };
    requests: {
        total: number;
        successful: number;
        failed: number;
        byMethod: Record<string, number>;
        byPath: Record<string, number>;
        byStatusCode: Record<number, number>;
    };
    performance: {
        avgTotalTime: number;
        avgRouteMatchTime: number;
        avgValidationTime: number;
        avgHandlerTime: number;
        avgResponseTime: number;
        p50TotalTime: number;
        p90TotalTime: number;
        p95TotalTime: number;
        p99TotalTime: number;
        minTotalTime: number;
        maxTotalTime: number;
    };
    memory: {
        avgHeapUsed: number;
        avgHeapTotal: number;
        maxHeapUsed: number;
        maxHeapTotal: number;
    };
    validation: {
        totalValidations: number;
        validationErrors: number;
        validationSuccessRate: number;
    };
    routing: {
        totalRoutes: number;
        routesWithMiddleware: number;
        dynamicRoutes: number;
        routeHitCount: Record<string, number>;
    };
}
interface MonitoringConfig {
    enabled: boolean;
    retention: {
        maxRecords: number;
        maxAge: number;
        cleanupInterval: number;
    };
    samplingRate: number;
    recordErrors: boolean;
    recordBodySize: boolean;
    recordResponseSize: boolean;
    thresholds: {
        slowRequest: number;
        highMemoryUsage: number;
        errorRate: number;
    };
}
interface MonitoringEvent {
    type: "request_start" | "request_end" | "validation_start" | "validation_end" | "error";
    timestamp: number;
    requestId: string;
    data: any;
}
interface PerformanceReport {
    id: string;
    timestamp: number;
    timeRange: {
        start: number;
        end: number;
    };
    summary: {
        totalRequests: number;
        avgResponseTime: number;
        errorRate: number;
        memoryUsage: number;
    };
    details: {
        topSlowestRoutes: Array<{
            path: string;
            avgTime: number;
            count: number;
        }>;
        topErrorRoutes: Array<{
            path: string;
            errorCount: number;
            errorRate: number;
        }>;
        memoryTrend: Array<{
            timestamp: number;
            heapUsed: number;
        }>;
        responseTimeDistribution: Record<string, number>;
    };
    recommendations: string[];
}

export type { AggregatedMetrics, BaseMetrics, MonitoringConfig, MonitoringEvent, PerformanceMetrics, PerformanceReport };
