{"version":3,"sources":["../../src/middleware/component-router.ts"],"sourcesContent":["import type {\n  ComponentRoute,\n  NestedComponentRoute,\n  FlattenedComponentRoute,\n} from \"../types/component-route\";\nimport { vueRenderer, reactRenderer } from \"./component-renderer\";\n\n/**\n * 扁平化嵌套组件路由\n */\nexport function flattenComponentRoutes(\n  routes: (ComponentRoute | NestedComponentRoute)[],\n): FlattenedComponentRoute[] {\n  const flattened: FlattenedComponentRoute[] = [];\n\n  function processRoute(\n    route: ComponentRoute | NestedComponentRoute,\n    parentPath: string = \"\",\n    parentMiddleware: any[] = [],\n  ) {\n    const currentPath = parentPath + route.path;\n    const currentMiddleware = [\n      ...parentMiddleware,\n      ...(route.middleware || []),\n    ];\n\n    if (\"component\" in route) {\n      // 这是一个组件路由\n      flattened.push({\n        ...route,\n        fullPath: currentPath,\n        middlewareChain: currentMiddleware,\n      });\n    } else if (\"children\" in route && route.children) {\n      // 这是一个嵌套路由\n      for (const child of route.children) {\n        processRoute(child, currentPath, currentMiddleware);\n      }\n    }\n  }\n\n  for (const route of routes) {\n    processRoute(route);\n  }\n\n  return flattened;\n}\n\n/**\n * 组件路由处理器中间件\n * 自动检测组件类型并应用相应的渲染器\n */\nexport const componentRouter = () => {\n  return async (req: Request, next: () => Promise<Response>) => {\n    // 这里可以添加组件路由的自动处理逻辑\n    // 比如自动检测组件类型，应用相应的渲染器\n    return next();\n  };\n};\n"],"mappings":";AAUO,SAAS,uBACd,QAC2B;AAC3B,QAAM,YAAuC,CAAC;AAE9C,WAAS,aACP,OACA,aAAqB,IACrB,mBAA0B,CAAC,GAC3B;AACA,UAAM,cAAc,aAAa,MAAM;AACvC,UAAM,oBAAoB;AAAA,MACxB,GAAG;AAAA,MACH,GAAI,MAAM,cAAc,CAAC;AAAA,IAC3B;AAEA,QAAI,eAAe,OAAO;AAExB,gBAAU,KAAK;AAAA,QACb,GAAG;AAAA,QACH,UAAU;AAAA,QACV,iBAAiB;AAAA,MACnB,CAAC;AAAA,IACH,WAAW,cAAc,SAAS,MAAM,UAAU;AAEhD,iBAAW,SAAS,MAAM,UAAU;AAClC,qBAAa,OAAO,aAAa,iBAAiB;AAAA,MACpD;AAAA,IACF;AAAA,EACF;AAEA,aAAW,SAAS,QAAQ;AAC1B,iBAAa,KAAK;AAAA,EACpB;AAEA,SAAO;AACT;AAMO,IAAM,kBAAkB,MAAM;AACnC,SAAO,OAAO,KAAc,SAAkC;AAG5D,WAAO,KAAK;AAAA,EACd;AACF;","names":[]}